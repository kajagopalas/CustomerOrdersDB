Year Table

CREATE TABLE DimYear (
    Year_ID INT NOT NULL PRIMARY KEY
)

Quarter Table

CREATE TABLE DimQuarter (
    Quarter_ID INT NOT NULL,
    Year_ID INT NOT NULL
)

Month Table

CREATE TABLE DimMonth (
    Month_ID INT NOT NULL,
    Month_Name VARCHAR(20) NOT NULL,
    Quarter_ID INT NOT NULL,
    Year_ID INT NOT NULL
)

CREATE TABLE DimDate (
    Date DATE NOT NULL PRIMARY KEY,
    Day_Of_Week INT NOT NULL,
    Day_Name VARCHAR(20) NOT NULL,
    Day_Of_Month INT NOT NULL,
    Week_Of_Year INT NOT NULL,
    Month_ID INT NOT NULL,
    Month_Name VARCHAR(20) NOT NULL,
    Quarter_ID INT NOT NULL,
    Year_ID INT NOT NULL,
    Is_Weekend CHAR(1) NOT NULL
)

-- Populate Year
INSERT INTO DimYear (Year_ID)
SELECT DISTINCT YEAR([Date])
FROM Calendar;

-- Populate Quarter
INSERT INTO DimQuarter (Quarter_ID, Year_ID)
SELECT DISTINCT DATEPART(QUARTER, [Date]), YEAR([Date])
FROM Calendar;

-- Populate Month
INSERT INTO DimMonth (Month_ID, Month_Name, Quarter_ID, Year_ID)
SELECT DISTINCT 
    MONTH([Date]),
    DATENAME(MONTH, [Date]),
    DATEPART(QUARTER, [Date]),
    YEAR([Date])
FROM Calendar;

-- Populate Date
INSERT INTO DimDate (
    Date, Day_Of_Week, Day_Name, Day_Of_Month, Week_Of_Year,
    Month_ID, Month_Name, Quarter_ID, Year_ID, Is_Weekend
)
SELECT DISTINCT 
    [Date],
    DATEPART(WEEKDAY, [Date]),
    DATENAME(WEEKDAY, [Date]),
    DATEPART(DAY, [Date]),
    DATEPART(WEEK, [Date]),
    MONTH([Date]),
    DATENAME(MONTH, [Date]),
    DATEPART(QUARTER, [Date]),
    YEAR([Date]),
    CASE WHEN DATENAME(WEEKDAY, [Date]) IN ('Saturday', 'Sunday') THEN 'Y' ELSE 'N' END
FROM Calendar;
